# 游戏需求文档

## 游戏概述
一款以格挡反击为核心玩法的动作游戏。玩家需要通过精准的格挡时机来反击敌人，同时管理有限的能量资源。

## 核心玩法机制

### 1. 移动系统
- **控制方式**: WASD 键控制主角移动
  - W: 向上移动
  - A: 向左移动
  - S: 向下移动
  - D: 向右移动
- **移动速度**: 中等速度，保证玩家能够灵活躲避和定位
- **移动范围**: 限制在游戏窗口内

### 2. 格挡系统
- **触发方式**: 长按空格键（或鼠标右键）进行格挡
- **能量消耗**: 
  - 格挡状态下持续消耗能量值
  - 消耗速率: 建议每秒消耗 20-30% 能量
- **格挡状态**:
  - 能量充足时: 可以正常格挡
  - 能量耗尽时: 无法进入格挡状态
  - 格挡中能量耗尽: 自动退出格挡状态
- **格挡判定**: 
  - 格挡状态下，敌人子弹/攻击接触到玩家时触发格挡成功
  - 格挡成功时有明显的视觉反馈（粒子爆发效果）

### 3. 格挡反击系统
- **触发条件**: 成功格挡住敌人的攻击
- **反击行为**:
  - 自动锁定最近的敌人
  - 瞬移到目标敌人位置
  - 对目标造成致命伤害（一击必杀）
  - 玩家位置移动到被击杀敌人的位置
- **反击动画**: 
  - 瞬移轨迹效果
  - 斩击特效
  - 大量粒子扰动
- **冷却时间**: 无冷却，可连续触发（取决于格挡成功）

### 4. 能量系统
- **能量上限**: 100 点
- **初始能量**: 100 点（满能量）
- **能量消耗**:
  - 格挡状态: 持续消耗
- **能量恢复**:
  - 自然恢复: 不格挡时缓慢恢复，恢复速率等于格挡消耗速率
  - 击杀恢复: 每次击杀敌人恢复 15-20 点能量
- **能量显示**: 屏幕上方显示能量条

## 敌人系统

### 敌人类型

#### 1. 远程敌人（基础敌人）
- **外观**: 红色三角形
- **行为**: 向玩家发射子弹
- **射击频率**: 每 1-2 秒发射一次
- **移动**: 缓慢移动或静止
- **与玩家距离**: 保持中远距离

#### 2. 近战敌人
- **外观**: 橙色/黄色菱形
- **行为**: 快速接近玩家并发动近战攻击
- **移动模式**:
  - 追击阶段: 快速向玩家移动（速度约为玩家的 1.2-1.5 倍）
  - 攻击范围: 进入攻击距离（50-80 像素）后停止移动
- **攻击机制**:
  - **警告阶段** (0.3-0.5 秒):
    - 菱形变大并闪烁（橙色 ↔ 白色）
    - 朝向玩家方向蓄力
    - 周围出现红色警告光圈逐渐扩大
  - **攻击阶段** (0.1-0.15 秒):
    - 快速向前突刺/冲锋
    - 攻击距离: 向前移动 80-100 像素
    - 留下橙色残影轨迹
  - **冷却阶段** (1-1.5 秒):
    - 攻击后短暂停顿
    - 恢复正常大小和颜色
    - 之后继续追击
- **格挡判定**:
  - 警告阶段: 不可格挡
  - 攻击阶段: 可以格挡，格挡成功触发反击
- **特点**:
  - 高威胁性，需要玩家精准把握格挡时机
  - 攻击速度快，但有明显预警
  - 增加游戏节奏变化和紧张感

### 敌人生成
- **生成位置**: 屏幕边缘随机位置
- **生成频率**: 根据游戏时间逐渐增加
- **最大数量**: 同时存在 5-10 个敌人
- **敌人配比**:
  - 初期: 仅生成远程敌人
  - 30 秒后: 开始混合生成近战敌人
  - 比例: 远程敌人 70%，近战敌人 30%

### 敌人子弹
- **外观**: 小型红色圆形或菱形
- **速度**: 中等速度，可被玩家反应
- **伤害**: 未格挡时击中玩家造成伤害/游戏结束

## 视觉设计

### 角色视觉
- **玩家**: 
  - 形状: 白色圆形
  - 大小: 直径 20-30 像素
  - 格挡状态: 外围出现蓝色/白色光环
  
- **敌人**: 
  - **远程敌人**:
    - 形状: 红色三角形
    - 大小: 边长 25-35 像素
    - 朝向: 三角形尖端指向玩家
  - **近战敌人**:
    - 形状: 橙色/黄色菱形
    - 大小: 正常 20-25 像素，蓄力时放大至 30-40 像素
    - 警告状态: 闪烁效果 + 红色光圈
    - 攻击状态: 橙色残影拖尾效果

### 粒子效果系统
- **背景粒子**:
  - 类型: 类似尘埃/星尘的小粒子
  - 数量: 500-1000 个粒子
  - 行为: 缓慢漂浮，营造氛围
  - 颜色: 半透明白色/蓝色/紫色渐变

- **粒子扰动**:
  - 玩家移动: 轻微推开周围粒子
  - 瞬移: 沿瞬移路径产生强烈扰动波纹
  - 格挡成功: 以玩家为中心向外爆发
  - 敌人死亡: 爆炸式粒子扩散

- **特效细节**:
  - 瞬移轨迹: 残影效果 + 粒子流
  - 斩击效果: 白色/蓝色光刃闪光
  - 子弹轨迹: 轻微粒子尾迹
  - 近战敌人警告: 红色扩散光圈 + 闪烁效果
  - 近战敌人冲锋: 橙色残影 + 粒子扰动

### 界面设计
- **能量条**: 
  - 位置: 屏幕上方中央
  - 样式: 横向进度条
  - 颜色: 蓝色（充足）→ 黄色（中等）→ 红色（不足）
  
- **分数/击杀数**: 
  - 位置: 屏幕左上角
  - 显示当前击杀数

- **游戏时间**: 
  - 位置: 屏幕右上角
  - 显示存活时间

## 游戏流程

### 开始
- 显示标题画面
- 按任意键开始游戏
- 玩家出现在屏幕中央

### 游戏进行
- 敌人持续生成
- 玩家通过格挡反击击杀敌人
- 难度随时间增加（敌人生成速度加快）

### 结束条件
- 玩家被子弹击中（未格挡状态）
- 显示最终分数和存活时间
- 提供重新开始选项

## 技术实现建议

### 推荐技术栈
- **游戏引擎**: HTML5 Canvas + JavaScript
- **可选框架**: 
  - Phaser.js（完整游戏框架）
  - PixiJS（高性能渲染）
  - 原生 Canvas（轻量级）

### 核心模块
1. **游戏循环**: requestAnimationFrame
2. **输入处理**: 键盘事件监听
3. **碰撞检测**: 圆形与圆形、圆形与三角形碰撞
4. **粒子系统**: 高效的粒子池管理
5. **状态管理**: 游戏状态机（菜单、游戏中、结束）

### 性能优化
- 粒子对象池复用
- 离屏对象剔除
- 碰撞检测空间分区

## 扩展功能（可选）

### 进阶玩法
- 多种敌人类型（不同攻击模式）
- 连击系统（连续格挡反击获得额外奖励）
- 技能系统（特殊能力）
- 关卡模式（波次挑战）

### 音效设计
- 格挡成功音效
- 瞬移斩击音效
- 背景音乐
- 敌人死亡音效

### 数据持久化
- 最高分记录
- 成就系统

## 开发优先级

### 第一阶段（核心玩法）
1. 基础移动系统
2. 简单的敌人和子弹
3. 格挡机制
4. 能量系统

### 第二阶段（反击系统）
1. 格挡反击瞬移
2. 敌人击杀
3. 能量恢复

### 第三阶段（视觉效果）
1. 背景粒子系统
2. 粒子扰动效果
3. 特效优化

### 第四阶段（完善）
1. UI 界面
2. 游戏流程
3. 平衡性调整
4. 音效添加

---

**文档版本**: 1.0  
**创建日期**: 2025-12-15  
**状态**: 待开发
