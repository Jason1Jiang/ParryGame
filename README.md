# 格挡反击游戏

一款以格挡反击为核心玩法的动作游戏。

## 如何运行

### 方法 1: 使用 Python（推荐）

1. 确保已安装 Python 3
2. 双击运行 `start.bat`
3. 在浏览器中访问 `http://localhost:8000`

### 方法 2: 使用 Node.js

如果你安装了 Node.js，可以使用 npx：

```bash
npx http-server -p 8000
```

然后在浏览器中访问 `http://localhost:8000`

### 方法 3: 使用其他 Web 服务器

使用任何本地 Web 服务器都可以，例如：
- VS Code 的 Live Server 扩展
- XAMPP
- WAMP
- 等等

## 游戏操作

- **WASD** - 移动
- **空格** - 格挡（消耗能量）
- **格挡成功** - 自动瞬移反击最近的敌人

## 配置文件

游戏的所有参数都在 `config.json` 中，你可以修改这个文件来调整：

- 玩家速度、大小
- 能量消耗和恢复速度
- 敌人的各项属性
- 粒子效果
- 生成规则
- 等等

修改后刷新浏览器即可看到效果。

## 文件说明

### 核心文件
- `index.html` - 游戏主页面
- `game.js` - 游戏逻辑代码
- `config.json` - 游戏配置参数
- `start.bat` - Windows 启动脚本

### 文档目录
所有文档已整理到 `docs/` 文件夹：

#### 需求文档 (`docs/requirements/`)
- `requirement.md` - 详细的游戏需求文档

#### 视觉更新文档 (`docs/visual-updates/`)
- `VISUAL_UPDATE_v2.1.md` - v2.1 闪光和刀光优化
- `VISUAL_UPDATE_v2.3.md` - v2.3 高优先级功能实现
- `VISUAL_UPDATE_v2.4.md` - v2.4 中优先级功能实现（最新）

#### 优化指南 (`docs/optimization/`)
- `CLARITY_OPTIMIZATION.md` - 清爽度优化指南
- `VISUAL_PRESETS.md` - 视觉风格预设配置

#### 参考文档 (`docs/reference/`)
- `VISUAL_EFFECTS.md` - 视觉效果系统说明
- `CHANGELOG.md` - 完整的修改日志

## 版本历史

### v3.5.3 - 排名显示与性能优化（2024-12-19）🏅
**新增功能**:
- ✅ **排名显示**: 提交成绩后立即显示此次的排名（第X名）
- ✅ **限制显示**: 排行榜最多显示前20名，提升加载速度
- ✅ **排名计算**: 自动计算全局排名，分数相同时先提交的排前面

**使用方法**:
- 提交分数后会弹窗显示排名
- 排行榜只显示前20名顶尖玩家

**详细文档**: [RANK_DISPLAY_v3.5.3.md](RANK_DISPLAY_v3.5.3.md)

### v3.5.2 - 排行榜用户体验优化（2024-12-19）✨
**用户体验改进**:
- ✅ **主动提交**: 游戏结束后显示 SUBMIT SCORE 按钮，用户主动选择是否提交
- ✅ **即时反馈**: 提交成功后自动显示排行榜，立即看到自己的排名
- ✅ **智能定位**: 排行榜自动切换到当前游戏的难度
- ✅ **灵活操作**: 可以跳过后重新选择，不再强制等待

**使用方法**:
- 游戏结束后点击 SUBMIT SCORE 提交分数
- 提交成功后自动显示排行榜
- 或直接点击 RESTART 重新开始

**详细文档**: [UX_IMPROVEMENT_v3.5.2.md](UX_IMPROVEMENT_v3.5.2.md)

### v3.5 - 云端排行榜系统（2024-12-19）🏆☁️
**重大功能更新**:
- ✅ **全球排行榜**: 基于 Firebase Realtime Database 的云端排行榜
- ✅ **难度分类**: 硬核、平衡、休闲三个独立排行榜
- ✅ **分数提交**: 游戏结束后输入名字提交分数
- ✅ **实时更新**: 排行榜数据实时同步
- ✅ **离线支持**: 本地缓存，离线可查看
- ✅ **简约设计**: 清晰的表格布局，前三名显示奖牌（🥇🥈🥉）

**Bug 修复** (v3.5.1):
- ✅ 修复参数顺序错误
- ✅ 修复时间显示问题
- ✅ 添加 Firebase 配置指南

**使用方法**:
- 主菜单点击 "RANKS" 查看排行榜
- 游戏结束后点击 SUBMIT SCORE 提交分数
- 切换难度标签查看不同排行榜

**详细文档**: 
- [CHANGELOG_v3.5.md](CHANGELOG_v3.5.md) - 版本更新日志
- [QUICK_START_v3.5.md](QUICK_START_v3.5.md) - 快速开始指南
- [BUGFIX_LEADERBOARD_v3.5.1.md](BUGFIX_LEADERBOARD_v3.5.1.md) - Bug 修复说明
- [UX_IMPROVEMENT_v3.5.2.md](UX_IMPROVEMENT_v3.5.2.md) - 用户体验改进
- [FIREBASE_SETUP_GUIDE.md](FIREBASE_SETUP_GUIDE.md) - Firebase 配置指南
- [LEADERBOARD_v3.5.md](docs/features/LEADERBOARD_v3.5.md) - 设计文档
- [LEADERBOARD_IMPLEMENTATION_v3.5.md](docs/features/LEADERBOARD_IMPLEMENTATION_v3.5.md) - 实现指南

### v3.4 - 多重反击连击关联系统（2024-12-18）⚡🔥
**核心优化**:
- ✅ **连击奖励**: 多重反击次数现在与连击数关联，连击越高反击越强
- ✅ **动态上限**: 从2次（0-2连击）到10次（50+连击）的线性增长
- ✅ **正向循环**: 高连击带来更强反击，更强反击帮助维持连击
- ✅ **成就感**: 高连击时的多重反击更加震撼

**连击对应表**:
```
0-2 连击   → 2次反击
3-4 连击   → 3次反击
5-9 连击   → 4次反击
10-14连击  → 5次反击
15-19连击  → 6次反击
20-29连击  → 7次反击
30-39连击  → 8次反击
40-49连击  → 9次反击
50+连击    → 10次反击（上限）
```

**详细文档**: 
- [MULTI_COUNTER_OPTIMIZATION_v3.4.md](docs/gameplay/MULTI_COUNTER_OPTIMIZATION_v3.4.md) - 完整设计文档
- [MULTI_COUNTER_IMPLEMENTATION_v3.4.md](MULTI_COUNTER_IMPLEMENTATION_v3.4.md) - 实现总结
- [MULTI_COUNTER_TEST_v3.4.md](docs/gameplay/MULTI_COUNTER_TEST_v3.4.md) - 测试指南

### v3.3 - 玩家死亡动画系统（2024-12-18）💀✨
**重大功能更新**:
- ✅ **粒子爆散**: 100个粒子从玩家位置向360度飞散，3种颜色分层
  - 30% 白色核心粒子（最亮，速度最快）
  - 50% 玩家色主体粒子（中等速度）
  - 20% 青色余烬粒子（速度慢，带拖尾）
- ✅ **延迟结算**: 死亡动画播放 **1.2秒** 后再显示结算界面 ⚡ (已优化)
- ✅ **视觉冲击**: 强烈震动（强度30，是普通格挡的3.75倍）、极慢时间（0.05x速度）、大型红色冲击波（半径200px）
- ✅ **动画时间线** (快速版本⚡): 
  - 0-200ms: 玩家缩小旋转（1.0→0.3，0°→360°）
  - 200-500ms: 粒子爆散（高速飞散）
  - 500-1000ms: 粒子消散（逐渐消失）
  - 1000-1200ms: 淡入黑色遮罩
  - 1200ms: 显示结算界面 ✅
- ✅ **粒子物理**: 重力影响、空气阻力、透明度衰减
- ✅ **配置灵活**: 可调整粒子数量（60-150）、动画时长（600-1500ms）、视觉效果强度，可完全禁用

**性能影响**: CPU +0.1-0.2ms/帧，GPU +0.2-0.3ms/帧，内存 +10KB（可忽略，动画仅持续1.2秒）

**时长优化**: 采用"快速死亡"预设，总时长从2.2秒优化到1.2秒，减少45%等待时间，提升游戏节奏 ⚡

**详细文档**: 
- [PLAYER_DEATH_v3.3.md](docs/visual-updates/PLAYER_DEATH_v3.3.md) - 完整设计文档
- [PLAYER_DEATH_IMPLEMENTATION.md](PLAYER_DEATH_IMPLEMENTATION.md) - 实现总结
- [TEST_PLAYER_DEATH.md](TEST_PLAYER_DEATH.md) - 测试指南
- [CHANGELOG_v3.3.md](CHANGELOG_v3.3.md) - 版本更新日志

### v3.0 - 视觉刷新：清爽简约风格（2024-12-17）🎨✨
**视觉大改版**:
- ✅ **纯白背景**: 从黑色改为纯白色，清爽舒适
- ✅ **1000个灰色粒子**: 密集的中灰色粒子，优雅点缀
- ✅ **黑白UI**: 能量条改为黑白渐变，统一风格
- ✅ **粒子扰动**: 所有移动和动作都会推开粒子

**详细说明**: 查看 [VISUAL_REFRESH_SUMMARY.md](VISUAL_REFRESH_SUMMARY.md)

### v2.9 - 调试界面与难度预设（2024-12-17）🎮⚙️
**新增功能**:
- ✅ **实时调试界面**: 显示刷怪速度、连击、敌人数量等关键数据，按 F3 切换
- ✅ **难度选择系统**: 三种预设难度（硬核、平衡、休闲），适合不同水平玩家
- ✅ **可视化反馈**: 根据数据状态显示不同颜色（正常/警告/危险）
- ✅ **配置预设管理**: 快速切换不同难度配置

**详细说明**: 查看 [SPAWN_SYSTEM_v2.9.md](docs/gameplay/SPAWN_SYSTEM_v2.9.md)

### v2.8 - 动态节奏调整（2024-12-16）⚡
**新增功能**:
- ✅ **击杀速度追踪**: 追踪最近5次击杀间隔，自动调整刷怪速度
- ✅ **连击加速系统**: 连击越高刷怪越快，最高可达2倍速度
- ✅ **敌人数量控制**: 维持场上敌人数量在目标范围，避免空档期
- ✅ **自适应难度**: 高手更刺激，新手更友好

**详细说明**: 查看 [SPAWN_SYSTEM_v2.8.md](docs/gameplay/SPAWN_SYSTEM_v2.8.md)

### v2.7 - 场内生成与特效（2024-12-16）✨
**新增功能**:
- ✅ **场内生成系统**: 敌人直接在场内刷新，避开玩家和其他敌人
- ✅ **淡入效果**: 敌人生成时有500ms淡入动画
- ✅ **无敌时间**: 生成后800ms无敌，避免瞬间被击杀
- ✅ **生成特效**: 粒子爆发、冲击波、音效

**详细说明**: 查看 [SPAWN_SYSTEM_v2.7.md](docs/gameplay/SPAWN_SYSTEM_v2.7.md)

### v2.5 - 多重反击系统（2024-12-15）⚡
**新增功能**:
- ✅ **多重反击**: 在按下格挡键的极短时间内（150ms）成功格挡，触发连续瞬移斩击多个敌人
- ✅ **紫色刀光**: 多重反击使用独特的紫色刀光特效
- ✅ **超强视觉**: 紫色闪光、超强震动、极慢时间（0.05倍速）

**详细说明**: 查看 [VISUAL_UPDATE_v2.5.md](docs/visual-updates/VISUAL_UPDATE_v2.5.md)

### v2.4 - 中优先级功能实现（2024-12-15）
**新增功能**:
- ✅ **连击特效强化**: 3连击时刀光宽度、粒子数量、发光强度全面增强，5连击触发彩虹刀光
- ✅ **完美格挡连击**: 连续完美格挡累积连击数，提供递增的能量奖励和时间减速效果
- ✅ **刀光音效同步**: 使用 Web Audio API 实现程序化音效系统

**详细说明**: 查看 [VISUAL_UPDATE_v2.4.md](docs/visual-updates/VISUAL_UPDATE_v2.4.md)

### v2.3 - 高优先级功能实现（2024-12-15）
**新增功能**:
- ✅ **刀光颜色渐变**: 青色 → 白色 → 金色的动态渐变效果
- ✅ **刀光残留效果**: 瞬移后刀光短暂停留并逐渐淡出
- ✅ **完美格挡判定**: 连续格挡触发完美格挡，获得金色特效和额外能量

**详细说明**: 查看 [VISUAL_UPDATE_v2.3.md](docs/visual-updates/VISUAL_UPDATE_v2.3.md)

### v2.2 - 清爽度优化（2024-12-15）
**优化内容**:
- ✅ 粒子数量减少 62.5%（800 → 300）
- ✅ 粒子透明度降低 50%
- ✅ 背景改为纯黑色
- ✅ 发光效果增强 50%

**详细说明**: 查看 [CLARITY_OPTIMIZATION.md](docs/optimization/CLARITY_OPTIMIZATION.md)

### v2.1 - 闪光和刀光优化（2024-12-15）
**优化内容**:
- ✅ 玩家本体闪光（替代全屏闪光）
- ✅ 多层刀光瞬移效果

**详细说明**: 查看 [VISUAL_UPDATE_v2.1.md](docs/visual-updates/VISUAL_UPDATE_v2.1.md)

## 配置指南

### 快速切换视觉风格
查看 [VISUAL_PRESETS.md](docs/optimization/VISUAL_PRESETS.md) 获取多种预设配置：
- 清爽简约（推荐）
- 深空氛围
- 极简竞技
- 华丽特效
- 暗夜模式
- 赛博朋克

### 自定义参数
所有视觉效果都可以在 `config.json` 中调整：
- 连击强化阈值和倍率
- 完美格挡时间窗口和奖励
- 音效频率和音量
- 粒子数量和透明度
- 刀光颜色和宽度

## 注意事项

⚠️ **不能直接双击打开 index.html**，必须通过 Web 服务器运行，否则配置文件无法加载。

## 开发日志

完整的开发历史和技术细节请查看 [CHANGELOG.md](docs/reference/CHANGELOG.md)。
