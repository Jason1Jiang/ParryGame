# Canvas边缘发光效果 - 测试指南

## 更新日期
2025-12-17

## 实现状态
✅ **已完成实现**

---

## 功能说明

### 1. 格挡边缘发光 🛡️
按住格挡键（空格/鼠标左键）时，Canvas 边缘出现淡蓝色发光效果。

**特性**：
- 颜色：淡蓝色 (#0CF)
- 强度：根据能量值动态变化
  - 能量充足 (>60%): 亮蓝色，宽度50px，透明度0.4
  - 能量中等 (30-60%): 中蓝色，宽度40px，透明度0.25
  - 能量不足 (<30%): 淡蓝色，宽度30px，透明度0.15
- 动画：轻微脉冲呼吸效果

### 2. 连击边缘发光 ⚡
击杀敌人时，根据连击数显示不同颜色和强度的边缘发光。

**连击颜色对应**：
- 1-2连击：白色 (#FFFFFF) - 弱发光，300ms
- 3-4连击：黄色 (#FFFF00) - 中等发光，400ms
- 5-9连击：橙色 (#FF8800) - 强发光，500ms
- 10-14连击：紫色 (#FF00FF) - 极强发光，600ms
- 15+连击：青色 (#00FFFF) - 最强发光，800ms

**动画效果**：
- 快速淡入（10%时间）
- 持续显示
- 缓慢淡出（20%时间）

---

## 测试步骤

### 测试1：格挡发光基础效果
```
步骤：
1. 启动游戏，选择任意难度
2. 按住空格键格挡
3. 观察 Canvas 四周边缘的蓝色发光

预期结果：
✅ 边缘出现淡蓝色发光
✅ 发光有轻微脉冲（呼吸感）
✅ 四条边（上下左右）都有发光
✅ 发光从边缘向内渐变
```

### 测试2：格挡发光能量变化
```
步骤：
1. 按住格挡键消耗能量
2. 观察能量条变化时边缘发光的变化
3. 能量耗尽后观察发光消失

预期结果：
✅ 能量充足时：发光明亮（宽度50px）
✅ 能量中等时：发光变弱（宽度40px）
✅ 能量不足时：发光很弱（宽度30px）
✅ 能量耗尽时：发光消失
✅ 脉冲速度随能量降低而加快
```

### 测试3：连击发光 - 低连击
```
步骤：
1. 击杀1-2个敌人
2. 观察边缘发光颜色和强度

预期结果：
✅ 击杀瞬间边缘出现白色发光
✅ 发光强度较弱（透明度0.3）
✅ 持续约300ms后淡出
✅ 有淡入淡出动画
```

### 测试4：连击发光 - 中连击
```
步骤：
1. 连续击杀3-4个敌人（保持连击）
2. 观察边缘发光颜色变化

预期结果：
✅ 3连击：边缘变为黄色
✅ 发光强度增强（透明度0.4）
✅ 持续约400ms
✅ 连击文字显示 "3x COMBO"
```

### 测试5：连击发光 - 高连击
```
步骤：
1. 连续击杀5-9个敌人
2. 观察边缘发光效果

预期结果：
✅ 5连击：边缘变为橙色
✅ 发光强度更强（透明度0.5）
✅ 宽度增加到60px
✅ 持续约500ms
✅ 视觉冲击力明显增强
```

### 测试6：连击发光 - 超高连击
```
步骤：
1. 连续击杀10个以上敌人
2. 观察边缘发光效果

预期结果：
✅ 10连击：边缘变为紫色
✅ 15连击：边缘变为青色
✅ 发光强度极强（透明度0.6-0.7）
✅ 宽度增加到70-80px
✅ 持续时间更长（600-800ms）
✅ 极强的视觉震撼感
```

### 测试7：效果叠加
```
步骤：
1. 按住格挡键（蓝色发光）
2. 击杀敌人触发连击（切换到连击颜色）
3. 等待连击发光结束
4. 观察是否恢复格挡发光

预期结果：
✅ 连击发光覆盖格挡发光
✅ 连击发光结束后恢复格挡发光
✅ 过渡流畅自然
✅ 无闪烁或跳变
```

### 测试8：性能测试
```
步骤：
1. 开启边缘发光
2. 长时间游玩（5-10分钟）
3. 频繁触发格挡和连击
4. 观察帧率和流畅度

预期结果：
✅ 帧率保持稳定（接近60fps）
✅ 无明显卡顿
✅ 边缘发光渲染流畅
✅ 不影响游戏体验
```

---

## 配置说明

边缘发光效果可以在 `config.json` 中配置：

```json
"visual": {
  "edgeGlow": {
    "enabled": true,  // 总开关
    
    "blocking": {
      "enabled": true,  // 格挡发光开关
      "baseColor": "#0CF",  // 基础颜色
      "minWidth": 30,  // 最小宽度
      "maxWidth": 50,  // 最大宽度
      "minAlpha": 0.15,  // 最小透明度
      "maxAlpha": 0.4,  // 最大透明度
      "pulseSpeed": {
        "high": 2.0,  // 能量充足时脉冲速度
        "medium": 1.5,  // 能量中等时脉冲速度
        "low": 1.0  // 能量不足时脉冲速度
      }
    },
    
    "combo": {
      "enabled": true,  // 连击发光开关
      "colors": {
        "1": "#FFFFFF",  // 1-2连击颜色
        "3": "#FFFF00",  // 3-4连击颜色
        "5": "#FF8800",  // 5-9连击颜色
        "10": "#FF00FF",  // 10-14连击颜色
        "15": "#00FFFF"  // 15+连击颜色
      },
      "intensity": {
        "1": { "alpha": 0.3, "width": 40, "duration": 300 },
        "3": { "alpha": 0.4, "width": 50, "duration": 400 },
        "5": { "alpha": 0.5, "width": 60, "duration": 500 },
        "10": { "alpha": 0.6, "width": 70, "duration": 600 },
        "15": { "alpha": 0.7, "width": 80, "duration": 800 }
      },
      "fadeIn": 0.1,  // 淡入时间比例
      "fadeOut": 0.2  // 淡出时间比例
    }
  }
}
```

---

## 调整建议

### 如果发光太强
```json
"blocking": {
  "maxAlpha": 0.3  // 降低最大透明度
}
"combo": {
  "intensity": {
    "15": { "alpha": 0.5 }  // 降低高连击透明度
  }
}
```

### 如果发光太弱
```json
"blocking": {
  "maxAlpha": 0.5,  // 提高最大透明度
  "maxWidth": 60  // 增加宽度
}
```

### 如果想要更快的脉冲
```json
"pulseSpeed": {
  "high": 3.0,
  "medium": 2.5,
  "low": 2.0
}
```

### 如果想要更长的连击发光
```json
"intensity": {
  "15": { "duration": 1200 }  // 延长到1.2秒
}
```

---

## 已知问题

无

---

## 下一步优化建议

### 1. 完美格挡特殊效果
- 触发条件：完美格挡
- 边缘效果：金色闪光
- 持续时间：0.2秒
- 强度：最高（alpha: 0.8）

### 2. 能量耗尽警告
- 触发条件：能量 < 10%
- 边缘效果：红色快速闪烁
- 闪烁频率：每秒3次

### 3. 多重反击特效
- 触发条件：多重反击激活
- 边缘效果：紫色 + 白色交替脉冲
- 持续时间：整个多重反击期间

---

## 相关文档

- [EDGE_GLOW_v3.2.md](EDGE_GLOW_v3.2.md) - 完整设计文档
- [VISUAL_REFRESH_v3.0.md](VISUAL_REFRESH_v3.0.md) - 视觉刷新基础
- [MENU_REFRESH_v3.1.md](MENU_REFRESH_v3.1.md) - 主界面优化

---

**文档版本**: v1.0  
**最后更新**: 2025-12-17  
**状态**: 已实现 ✅
