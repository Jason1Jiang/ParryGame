# æ›´æ–°æ—¥å¿— v3.4 - å¤šé‡åå‡»è¿žå‡»å…³è”ç³»ç»Ÿ

## æ›´æ–°æ—¥æœŸ
2025-12-18

## ç‰ˆæœ¬ä¿¡æ¯
- **ç‰ˆæœ¬å·**: v3.4
- **ç±»åž‹**: åŠŸèƒ½ä¼˜åŒ–
- **ä¼˜å…ˆçº§**: ä¸­
- **å½±å“èŒƒå›´**: å¤šé‡åå‡»ç³»ç»Ÿ

---

## æ›´æ–°æ¦‚è¿°

å°†å¤šé‡åå‡»æ¬¡æ•°ä¸Žè¿žå‡»æ•°å…³è”ï¼Œè®©çŽ©å®¶çš„è¿žå‡»æˆå°±ç›´æŽ¥è½¬åŒ–ä¸ºæ›´å¼ºå¤§çš„åå‡»èƒ½åŠ›ï¼Œå½¢æˆæ­£å‘åé¦ˆå¾ªçŽ¯ã€‚

### æ ¸å¿ƒæ”¹åŠ¨
- âœ… å¤šé‡åå‡»æ¬¡æ•°çŽ°åœ¨æ ¹æ®è¿žå‡»æ•°åŠ¨æ€å˜åŒ–
- âœ… è¿žå‡»è¶Šé«˜ï¼Œå¤šé‡åå‡»èƒ½å‡»æ€çš„æ•Œäººè¶Šå¤š
- âœ… ä»Ž2æ¬¡ï¼ˆä½Žè¿žå‡»ï¼‰åˆ°10æ¬¡ï¼ˆé«˜è¿žå‡»ï¼‰çš„çº¿æ€§å¢žé•¿
- âœ… ä¿æŒç®€æ´ï¼Œæ— é¢å¤–è§†è§‰åé¦ˆ

---

## è¯¦ç»†åŠŸèƒ½

### 1. è¿žå‡»å¯¹åº”è¡¨

| è¿žå‡»æ•° | å¤šé‡åå‡»æ¬¡æ•° | æå‡å¹…åº¦ |
|--------|--------------|----------|
| 0-2    | 2æ¬¡          | åŸºç¡€     |
| 3-4    | 3æ¬¡          | +50%     |
| 5-9    | 4æ¬¡          | +100%    |
| 10-14  | 5æ¬¡          | +150%    |
| 15-19  | 6æ¬¡          | +200%    |
| 20-29  | 7æ¬¡          | +250%    |
| 30-39  | 8æ¬¡          | +300%    |
| 40-49  | 9æ¬¡          | +350%    |
| 50+    | 10æ¬¡ï¼ˆä¸Šé™ï¼‰ | +400%    |

### 2. è®¾è®¡ç†å¿µ

#### æ­£å‘åé¦ˆå¾ªçŽ¯
```
é«˜è¿žå‡» â†’ æ›´å¼ºåå‡» â†’ æ›´å®¹æ˜“ç»´æŒè¿žå‡» â†’ æ›´é«˜è¿žå‡» â†’ æ›´å¼ºåå‡»
```

#### æˆå°±æ„Ÿé€’å¢ž
- ä½Žè¿žå‡»ï¼ˆ0-9ï¼‰ï¼šæ­£å¸¸éš¾åº¦ï¼Œéœ€è¦è°¨æ…Žæ“ä½œ
- ä¸­è¿žå‡»ï¼ˆ10-29ï¼‰ï¼šæœ‰æ˜Žæ˜¾ä¼˜åŠ¿ï¼Œä½†ä¸æ— æ•Œ
- é«˜è¿žå‡»ï¼ˆ30-49ï¼‰ï¼šå¼ºå¤§å¨åŠ›ï¼Œé«˜åº¦æˆå°±æ„Ÿ
- æžé™è¿žå‡»ï¼ˆ50+ï¼‰ï¼šæœ€å¼ºå¨åŠ›ï¼Œå¥–åŠ±çŽ©å®¶çš„é«˜è¶…æŠ€æœ¯

---

## æŠ€æœ¯å®žçŽ°

### 1. é…ç½®ä¿®æ”¹

#### config.json
åœ¨ `visual.multiCounter` ä¸­æ·»åŠ äº† `comboScaling` é…ç½®ï¼š

```json
"multiCounter": {
  "enabled": true,
  "timeWindow": 150,
  "maxTargets": 3,
  "delayBetweenCounters": 200,
  "flashColor": "#ff00ff",
  "trailColor": "#ff00ff",
  "bonusEnergy": 20,
  "screenShakeIntensity": 20,
  "timeSlowScale": 0.05,
  "timeSlowDuration": 500,
  "comboScaling": {
    "enabled": true,
    "thresholds": [0, 3, 5, 10, 15, 20, 30, 40, 50],
    "counts": [2, 3, 4, 5, 6, 7, 8, 9, 10]
  }
}
```

### 2. ä»£ç ä¿®æ”¹

#### æ–°å¢žå‡½æ•°ï¼šgetMultiCounterLimit()
```javascript
// èŽ·å–å½“å‰è¿žå‡»å¯¹åº”çš„å¤šé‡åå‡»æ¬¡æ•°ä¸Šé™
function getMultiCounterLimit() {
    const cfg = CONFIG.visual?.multiCounter;
    if (!cfg || !cfg.enabled) return 3;
    
    const scaling = cfg.comboScaling;
    if (!scaling || !scaling.enabled) {
        return cfg.maxTargets; // å¦‚æžœæœªå¯ç”¨è¿žå‡»ç¼©æ”¾ï¼Œè¿”å›žé»˜è®¤å€¼
    }
    
    // æ ¹æ®è¿žå‡»æ•°æŸ¥æ‰¾å¯¹åº”çš„æ¬¡æ•°
    for (let i = scaling.thresholds.length - 1; i >= 0; i--) {
        if (comboCount >= scaling.thresholds[i]) {
            return scaling.counts[i];
        }
    }
    
    return scaling.counts[0]; // é»˜è®¤è¿”å›žç¬¬ä¸€ä¸ªå€¼
}
```

#### ä¿®æ”¹å‡½æ•°ï¼štriggerMultiCounter()
```javascript
// è§¦å‘å¤šé‡åå‡»
function triggerMultiCounter() {
    const cfg = CONFIG.visual?.multiCounter;
    if (!cfg || !cfg.enabled || multiCounterActive) return;
    
    // èŽ·å–å½“å‰è¿žå‡»å¯¹åº”çš„å¤šé‡åå‡»æ¬¡æ•°ä¸Šé™
    const maxTargets = getMultiCounterLimit(); // â† ä½¿ç”¨åŠ¨æ€ä¸Šé™
    
    // æ‰¾åˆ°æœ€è¿‘çš„å¤šä¸ªæ•Œäººï¼ˆæŽ’é™¤æ— æ•Œçš„æ•Œäººï¼‰
    const targets = [];
    const validEnemies = enemies.filter(e => !isEnemyInvincible(e));
    const sortedEnemies = validEnemies.slice().sort((a, b) => {
        const distA = Math.hypot(a.x - player.x, a.y - player.y);
        const distB = Math.hypot(b.x - player.x, b.y - player.y);
        return distA - distB;
    });
    
    for (let i = 0; i < Math.min(maxTargets, sortedEnemies.length); i++) {
        targets.push(sortedEnemies[i]);
    }
    
    // ... å…¶ä½™ä»£ç ä¸å˜
}
```

---

## æ¸¸æˆå¹³è¡¡æ€§

### ä½Žè¿žå‡»é˜¶æ®µï¼ˆ0-9è¿žå‡»ï¼‰
```
å¤šé‡åå‡»ï¼š2-4æ¬¡
å¨èƒç­‰çº§ï¼šä½Ž-ä¸­
å¹³è¡¡æ€§ï¼šâœ… è‰¯å¥½
è¯´æ˜Žï¼šçŽ©å®¶ä»éœ€è°¨æ…Žæ“ä½œ
```

### ä¸­è¿žå‡»é˜¶æ®µï¼ˆ10-29è¿žå‡»ï¼‰
```
å¤šé‡åå‡»ï¼š5-7æ¬¡
å¨èƒç­‰çº§ï¼šä¸­-é«˜
å¹³è¡¡æ€§ï¼šâœ… è‰¯å¥½
è¯´æ˜Žï¼šçŽ©å®¶æœ‰æ˜Žæ˜¾ä¼˜åŠ¿ä½†ä¸æ— æ•Œ
```

### é«˜è¿žå‡»é˜¶æ®µï¼ˆ30-49è¿žå‡»ï¼‰
```
å¤šé‡åå‡»ï¼š8-9æ¬¡
å¨èƒç­‰çº§ï¼šé«˜
å¹³è¡¡æ€§ï¼šâš ï¸ éœ€è¦æµ‹è¯•
è¯´æ˜Žï¼šçŽ©å®¶ä¼˜åŠ¿æ˜Žæ˜¾ï¼Œä½†ä»å¯èƒ½å¤±è¯¯
```

### æžé™è¿žå‡»é˜¶æ®µï¼ˆ50+è¿žå‡»ï¼‰
```
å¤šé‡åå‡»ï¼š10æ¬¡ï¼ˆä¸Šé™ï¼‰
å¨èƒç­‰çº§ï¼šæžé«˜
å¹³è¡¡æ€§ï¼šâš ï¸ å¯èƒ½è¿‡å¼º
è¯´æ˜Žï¼šçŽ©å®¶å‡ ä¹Žæ— æ•Œï¼Œä½†è¾¾åˆ°æ­¤é˜¶æ®µæœ¬èº«å°±æ˜¯æˆå°±
```

---

## é…ç½®è°ƒæ•´

### å¦‚æžœè§‰å¾—å¤ªå¼º
```json
// æ–¹æ¡ˆ1ï¼šé™ä½Žä¸Šé™
"counts": [2, 3, 4, 5, 5, 6, 6, 7, 7]

// æ–¹æ¡ˆ2ï¼šæé«˜é˜ˆå€¼
"thresholds": [0, 5, 10, 15, 25, 35, 50, 70, 100]
```

### å¦‚æžœè§‰å¾—å¤ªå¼±
```json
// æ–¹æ¡ˆ1ï¼šæé«˜ä¸Šé™
"counts": [3, 4, 5, 6, 7, 8, 10, 12, 15]

// æ–¹æ¡ˆ2ï¼šé™ä½Žé˜ˆå€¼
"thresholds": [0, 2, 4, 7, 10, 15, 20, 30, 40]
```

### ç¦ç”¨åŠŸèƒ½
```json
"comboScaling": {
  "enabled": false
}
```

---

## æ€§èƒ½å½±å“

### CPU
- **å½±å“**: æ— 
- **è¯´æ˜Ž**: åªæ˜¯ç®€å•çš„æ•°ç»„æŸ¥æ‰¾ï¼Œæ€§èƒ½å¼€é”€å¯å¿½ç•¥

### å†…å­˜
- **å½±å“**: æ— 
- **è¯´æ˜Ž**: åªå¢žåŠ äº†é…ç½®æ•°æ®ï¼Œçº¦100å­—èŠ‚

### å¸§çŽ‡
- **å½±å“**: æ— 
- **è¯´æ˜Ž**: ä¸å½±å“æ¸²æŸ“æ€§èƒ½

---

## æµ‹è¯•åœºæ™¯

### æµ‹è¯•1ï¼šä½Žè¿žå‡»ï¼ˆ0-9ï¼‰
```
æ­¥éª¤ï¼š
1. å¼€å§‹æ¸¸æˆ
2. å‡»æ€1-9ä¸ªæ•Œäºº
3. è§¦å‘å¤šé‡åå‡»
4. è§‚å¯Ÿå‡»æ€æ•°é‡

é¢„æœŸç»“æžœï¼š
âœ… 0-2è¿žå‡»ï¼šå‡»æ€2ä¸ªæ•Œäºº
âœ… 3-4è¿žå‡»ï¼šå‡»æ€3ä¸ªæ•Œäºº
âœ… 5-9è¿žå‡»ï¼šå‡»æ€4ä¸ªæ•Œäºº
```

### æµ‹è¯•2ï¼šä¸­è¿žå‡»ï¼ˆ10-29ï¼‰
```
æ­¥éª¤ï¼š
1. ç»´æŒ10-29è¿žå‡»
2. è§¦å‘å¤šé‡åå‡»
3. è§‚å¯Ÿå‡»æ€æ•°é‡

é¢„æœŸç»“æžœï¼š
âœ… 10-14è¿žå‡»ï¼šå‡»æ€5ä¸ªæ•Œäºº
âœ… 15-19è¿žå‡»ï¼šå‡»æ€6ä¸ªæ•Œäºº
âœ… 20-29è¿žå‡»ï¼šå‡»æ€7ä¸ªæ•Œäºº
```

### æµ‹è¯•3ï¼šé«˜è¿žå‡»ï¼ˆ30+ï¼‰
```
æ­¥éª¤ï¼š
1. ç»´æŒ30+è¿žå‡»
2. è§¦å‘å¤šé‡åå‡»
3. è§‚å¯Ÿå‡»æ€æ•°é‡å’Œå¹³è¡¡æ€§

é¢„æœŸç»“æžœï¼š
âœ… 30-39è¿žå‡»ï¼šå‡»æ€8ä¸ªæ•Œäºº
âœ… 40-49è¿žå‡»ï¼šå‡»æ€9ä¸ªæ•Œäºº
âœ… 50+è¿žå‡»ï¼šå‡»æ€10ä¸ªæ•Œäºº
âœ… æ¸¸æˆä»æœ‰æŒ‘æˆ˜æ€§
```

---

## ç”¨æˆ·åé¦ˆï¼ˆé¢„æœŸï¼‰

### æ­£é¢åé¦ˆ
- "è¿žå‡»è¶Šé«˜è¶Šçˆ½ï¼"
- "10è¿žå‡»åŽçš„å¤šé‡åå‡»å¤ªéœ‡æ’¼äº†ï¼"
- "ç»ˆäºŽæœ‰ç†ç”±ç»´æŒé«˜è¿žå‡»äº†ï¼"
- "çœ‹åˆ°èƒ½å‡»æ€æ›´å¤šæ•Œäººå¾ˆæœ‰æˆå°±æ„Ÿï¼"

### å¯èƒ½çš„é—®é¢˜
- "50è¿žå‡»åŽå¤ªå¼ºäº†ï¼Œæ²¡æœ‰æŒ‘æˆ˜æ€§"
- "è¿žå‡»æ–­äº†ä¹‹åŽåå‡»å˜å¼±å¾ˆæ˜Žæ˜¾"

### è§£å†³æ–¹æ¡ˆ
- å¦‚æžœå¤ªå¼ºï¼šé™ä½Žä¸Šé™æˆ–æé«˜é˜ˆå€¼
- å¦‚æžœå¤ªå¼±ï¼šæé«˜ä¸Šé™æˆ–é™ä½Žé˜ˆå€¼
- å¯ä»¥é€šè¿‡é…ç½®çµæ´»è°ƒæ•´

---

## ç›¸å…³æ–‡æ¡£

### è®¾è®¡æ–‡æ¡£
- [MULTI_COUNTER_OPTIMIZATION_v3.4.md](docs/gameplay/MULTI_COUNTER_OPTIMIZATION_v3.4.md) - å®Œæ•´è®¾è®¡æ–‡æ¡£ï¼ˆåŒ…å«4ä¸ªæ–¹æ¡ˆå¯¹æ¯”ï¼‰

### å®žçŽ°æ–‡æ¡£
- [MULTI_COUNTER_IMPLEMENTATION_v3.4.md](MULTI_COUNTER_IMPLEMENTATION_v3.4.md) - å®žçŽ°æ€»ç»“

### æµ‹è¯•æ–‡æ¡£
- [MULTI_COUNTER_TEST_v3.4.md](docs/gameplay/MULTI_COUNTER_TEST_v3.4.md) - è¯¦ç»†æµ‹è¯•æŒ‡å—

### é…ç½®æ–‡ä»¶
- [config.json](config.json) - æ¸¸æˆé…ç½®

### ä»£ç æ–‡ä»¶
- [game.js](game.js) - æ¸¸æˆé€»è¾‘

---

## å¼€å‘æ—¶é—´çº¿

- **2025-12-18 14:00** - éœ€æ±‚ç¡®è®¤
- **2025-12-18 14:30** - è®¾è®¡æ–‡æ¡£å®Œæˆ
- **2025-12-18 15:00** - ä»£ç å®žçŽ°å®Œæˆ
- **2025-12-18 15:30** - æµ‹è¯•æ–‡æ¡£å®Œæˆ
- **2025-12-18 16:00** - æ›´æ–°æ—¥å¿—å®Œæˆ

---

## ä¸‹ä¸€æ­¥

### çŸ­æœŸ
- [ ] æ”¶é›†çŽ©å®¶æµ‹è¯•åé¦ˆ
- [ ] æ ¹æ®åé¦ˆè°ƒæ•´å‚æ•°
- [ ] ä¼˜åŒ–å¹³è¡¡æ€§

### ä¸­æœŸ
- [ ] è€ƒè™‘æ·»åŠ è¿žå‡»é˜ˆå€¼æç¤ºï¼ˆå¯é€‰ï¼‰
- [ ] è€ƒè™‘æ·»åŠ å¤šé‡åå‡»æ¬¡æ•°æ˜¾ç¤ºï¼ˆå¯é€‰ï¼‰
- [ ] ä¼˜åŒ–é«˜è¿žå‡»æ—¶çš„éš¾åº¦æ›²çº¿

### é•¿æœŸ
- [ ] æ·»åŠ è¿žå‡»ç›¸å…³çš„æˆå°±ç³»ç»Ÿ
- [ ] æ·»åŠ è¿žå‡»ç»Ÿè®¡æ•°æ®
- [ ] ä¼˜åŒ–è¿žå‡»ç³»ç»Ÿçš„æ·±åº¦

---

## æ€»ç»“

### ä¼˜ç‚¹
- âœ… è¿žå‡»å¥–åŠ±æ˜Žæ˜¾
- âœ… æ­£å‘åé¦ˆå¾ªçŽ¯å¼º
- âœ… é«˜è¿žå‡»æˆå°±æ„Ÿå¼º
- âœ… å®žçŽ°ç®€æ´
- âœ… å¯é…ç½®åŒ–
- âœ… æ— æ€§èƒ½å½±å“

### æ³¨æ„äº‹é¡¹
- âš ï¸ é«˜è¿žå‡»æ—¶å¯èƒ½è¿‡å¼ºï¼Œéœ€è¦æµ‹è¯•
- âš ï¸ å¯èƒ½éœ€è¦æ ¹æ®åé¦ˆè°ƒæ•´å‚æ•°
- âš ï¸ å»ºè®®å…ˆæµ‹è¯•å†éƒ¨ç½²

### æŽ¨èé…ç½®
- **å½“å‰é…ç½®**ï¼šé€‚åˆå¤§å¤šæ•°çŽ©å®¶
- **å¦‚æžœå¤ªå¼º**ï¼šé™ä½Žä¸Šé™åˆ°7æˆ–æé«˜é˜ˆå€¼
- **å¦‚æžœå¤ªå¼±**ï¼šæé«˜ä¸Šé™åˆ°15æˆ–é™ä½Žé˜ˆå€¼

---

**æ›´æ–°å®Œæˆæ—¶é—´**: 2025-12-18  
**ç‰ˆæœ¬**: v3.4  
**çŠ¶æ€**: âœ… å·²å®Œæˆå¹¶è®°å½•

å¼€å§‹æµ‹è¯•å§ï¼ðŸš€
